# [P1160 队列安排](https://www.luogu.com.cn/problem/P1160)

## 题目描述

一个学校里老师要将班上N个同学排成一列，同学被编号为 1∼ N ，他采取如下的方法：

1. 先将11号同学安排进队列，这时队列中只有他一个人；
2. 2 - N 号同学依次入列，编号为i的同学入列方式为：老师指定编号为i的同学站在编号为1∼ ( i − 1 ) 中某位同学（即之前已经入列的同学）的左边或右边；
3. 从队列中去掉M(M<N)个同学，其他同学位置顺序不变。

在所有同学按照上述方法队列排列完毕后，老师想知道从左到右所有同学的编号。

## 输入格式

第1行为一个正整数N，表示了有N个同学。

第2-N行，第i*i*行包含两个整数 k, p ，其中 k 为小于 i 的正整数，p 为 0 或者 1 。若 p 为 0 ，则表示将 i 号同学插入到 k 号同学的左边，p 为 1 则表示插入到右边。

第 N+1 行为一个正整数 M ，表示去掉的同学数目。

接下来 M 行，每行一个正整数 x ，表示将 x 号同学从队列中移去，如果 x 号同学已经不在队列中则忽略这一条指令。

## 输出格式

1行，包含最多 N 个空格隔开的正整数，表示了队列从左到右所有同学的编号，行末换行且无空格。

## 输入输出样例

**输入 #1**复制

```
4
1 0
2 1
1 0
2
3
3
```

**输出 #1**复制

```
2 4 1
```

## 说明/提示

样例解释：

将同学22插入至同学11左边，此时队列为：

2 1

将同学33插入至同学22右边，此时队列为：

2 3 1

将同学44插入至同学11左边，此时队列为：

2 3 4 1

将同学33从队列中移出，此时队列为：

2 4 1

同学33已经不在队列中，忽略最后一条指令

最终队列：

2 4 1

数据范围

对于20%的数据，有N≤10；

对于40%的数据，有N≤1000；

对于100%的数据，有N, M≤100000。



***

双向链表，不多说了。

***



```c++
#include <bits/stdc++.h>
using namespace std;
int a[100010][4],n,m;
int main()
{
    scanf("%d",&n); int j=1;
    memset(a,0,sizeof(a)); a[1][1]=1;
    for(int i=2;i<=n;i++)
    {
        int x,y; scanf("%d %d",&x,&y);
        a[i][1]=i;
        if(y==0)
        {
            a[a[x][3]][2]=i; a[i][2]=x;
            a[i][3]=a[x][3]; a[x][3]=i;
            if(x==j) j=i;
        }
        else
        {
            a[i][2]=a[x][2]; a[a[x][2]][3]=i;
            a[x][2]=i; a[i][3]=x;
        }
    }
    scanf("%d",&m);
    for(int i=1;i<=m;i++)
    {
        int x; scanf("%d",&x);
        if(a[x][1]!=0)
        {
            a[x][1]=0;
            a[a[x][3]][2]=a[x][2];
            a[a[x][2]][3]=a[x][3];
            n--;
            if(x==j) j=a[x][3];
        }
    }
    int i=1,x=j;
    while(i<=n)
    {
        printf("%d ",a[x][1]);
        x=a[x][2]; i++;
    }
    return 0;
}
```

